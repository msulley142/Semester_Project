
<!--The html template was heavily edited using AI Generated Code -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{{ profile_user.username }} - Profile - Calibration</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="{% static 'css/base.css' %}">

  <style>
        :root {
      /* --- CALIBRATION THEME --- */
      --bg: #EEEEEE;
      --bg-soft: #C3E4E9;

      --card: #FFFFFF;
      --card-soft: #EAF3F6;

      --accent: #056C89;
      --accent-soft: #88B4BE;
      --accent-strong: #023653;

      --text-main: #022432;
      --text-muted: #4B6770;

      --border-subtle: #C5D4D8;

      --radius-lg: 18px;
      --radius-md: 12px;
      --radius-pill: 999px;

      --shadow-soft: 0 16px 40px rgba(2, 54, 83, 0.18);

      --sidebar-w: 260px;

      --bg-sidebar: #023653;
      --danger: #ef4444;
      --success: #22c55e;
    }

    *, *::before, *::after { box-sizing: border-box; }

    html, body {
      margin: 0;
      padding: 0;
      min-height: 100%;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Inter, sans-serif;
      background: var(--bg);
      color: var(--text-main);
    }

    a { color: inherit; text-decoration: none; }

    /* APP SHELL */
    .app-shell {
      display: grid;
      grid-template-columns: var(--sidebar-w) minmax(0, 1fr);
      min-height: 100vh;
    }

    @media (max-width: 900px) {
      .app-shell {
        grid-template-columns: 1fr;
      }
    }

    /* SIDEBAR (same as user profile) */
    .sidebar {
      background: linear-gradient(180deg, #023653 0%, #000000 100%);
      color: #E5E7EB;
      border-right: 1px solid #000000;
      padding: 18px 18px 20px;
      display: flex;
      flex-direction: column;
      gap: 18px;

      position: sticky;
      top: 0;
      height: 100vh;
      align-self: start;
      z-index: 40;
      box-shadow: 10px 0 30px rgba(0, 0, 0, 0.5);
    }

    @media (max-width: 900px) {
      .sidebar {
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
        height: auto;
        box-shadow: none;
      }
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand-mark {
      width: 36px;
      height: 36px;
      border-radius: 999px;
      background: linear-gradient(135deg, var(--accent), var(--accent-soft));
      display: flex;
      align-items: center;
      justify-content: center;
      color: #f9fafb;
      font-weight: 800;
      font-size: 0.9rem;
      box-shadow: 0 0 0 2px #000000;
    }

    .brand-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .brand-title {
      font-size: 1rem;
      font-weight: 700;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: #F9FAFB;
    }

    .brand-subtitle {
      font-size: 0.72rem;
      color: #D1E2F2;
    }

    /* MAIN LAYOUT */
    .site-main {
      padding-bottom: 40px;
      background:
        radial-gradient(circle at top left, rgba(136, 180, 190, 0.22), transparent 60%),
        var(--bg);
    }

    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
    }

    .site-header {
      margin: 0 0 18px;
      padding: 14px 24px 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      border-bottom: 1px solid var(--border-subtle);
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      position: sticky;
      top: 0;
      z-index: 10;
      box-shadow: 0 6px 16px rgba(2, 54, 83, 0.08);
    }

    @media (max-width: 640px) {
      .site-header {
        flex-wrap: wrap;
        padding: 12px 16px;
      }
    }

    .site-header-title h1 {
      margin: 0;
      font-size: 1.05rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
    }

    .site-header-title span {
      font-size: 0.82rem;
      color: var(--text-muted);
    }

    .header-actions {
      display: inline-flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 7px 12px;
      border-radius: var(--radius-pill);
      font-size: 0.8rem;
      font-weight: 500;
      border: 1px solid var(--border-subtle);
      background: #FFFFFF;
      color: var(--text-main);
      cursor: pointer;
      transition:
        background 0.15s ease,
        box-shadow 0.15s ease,
        transform 0.1s ease,
        border-color 0.15s ease;
    }

    .btn-sm {
      padding: 4px 9px;
      font-size: 0.76rem;
    }

    .btn:hover {
      background: #F5FAFB;
      border-color: #B4C7CD;
      box-shadow: 0 6px 16px rgba(2, 54, 83, 0.18);
      transform: translateY(-1px);
    }

    .btn-primary {
      border-color: transparent;
      background: var(--accent);
      color: #F2FBFF;
      box-shadow: 0 10px 25px rgba(5, 108, 137, 0.45);
    }

    .btn-primary:hover {
      background: #045975;
    }

    .btn-ghost {
      background: #F5FAFB;
    }

    /* PROFILE PAGE SHELL */
    .profile-page {
      padding: 16px 20px;
    }

    @media (max-width: 640px) {
      .profile-page {
        padding: 12px 10px;
      }
    }

    .card {
      background: var(--card);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-subtle);
      box-shadow: var(--shadow-soft);
    }

    /* COVER + HEADER */
    .profile-cover {
      position: relative;
      overflow: hidden;
      border-radius: var(--radius-lg);
      margin-bottom: 12px;
      background: radial-gradient(circle at 0% 0%, #27B0C7 0, #056C89 40%, #011824 100%);
      color: #E5EDFF;
    }

    .profile-cover-banner {
      height: 180px;
      background-image:
        linear-gradient(120deg, rgba(136, 180, 190, 0.65), rgba(5,108,137,0.9)),
        url("{% static 'img/calibration-cover-pattern.svg' %}");
      background-size: cover;
      background-position: center;
      position: relative;
    }

    .profile-cover-overlay {
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 10% 0%, rgba(191,219,254,0.4), transparent 55%);
      opacity: 0.85;
      pointer-events: none;
    }

    .profile-main-row {
      display: grid;
      grid-template-columns: minmax(0, 2.4fr) minmax(0, 1.6fr);
      gap: 16px;
      padding: 0 20px 16px;
      transform: translateY(-40px);
    }

    @media (max-width: 780px) {
      .profile-main-row {
        grid-template-columns: minmax(0, 1fr);
        transform: translateY(-30px);
        padding: 0 14px 14px;
      }
    }

    .profile-ident-row {
      display: flex;
      gap: 14px;
      align-items: flex-end;
    }

    .profile-avatar-wrap {
      position: relative;
      width: 120px;
      height: 120px;
      border-radius: 999px;
      border: 4px solid #E5EDFF;
      overflow: hidden;
      box-shadow: 0 18px 32px rgba(2, 20, 33, 0.7);
      background: #011627;
      flex-shrink: 0;
    }

    .profile-avatar-wrap img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .profile-name-meta {
      display: flex;
      flex-direction: column;
      gap: 6px;
      padding-bottom: 6px;
    }

    .profile-name-meta h2 {
      margin: 0;
      font-size: 1.4rem;
      letter-spacing: 0.02em;
    }

    .profile-tagline {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      font-size: 0.82rem;
      align-items: center;
    }

    .profile-pill {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(1, 15, 25, 0.45);
      border: 1px solid rgba(191, 219, 254, 0.8);
      font-size: 0.76rem;
    }

    .profile-bio {
      font-size: 0.84rem;
      max-width: 420px;
      color: #E0EDFF;
    }

    .profile-actions-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: flex-end;
      align-items: flex-end;
      padding-bottom: 6px;
    }

    .profile-stats-row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 10px;
      font-size: 0.8rem;
    }

    .profile-stat-pill {
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(1, 18, 36, 0.5);
      border: 1px solid rgba(191, 219, 254, 0.7);
      display: inline-flex;
      gap: 6px;
      align-items: center;
    }

    .profile-stat-label { opacity: 0.85; }
    .profile-stat-value { font-weight: 600; }

    /* SUB NAV */
    .profile-subnav-wrap {
      padding: 0 20px 12px;
      margin-top: -22px;
    }

    @media (max-width: 780px) {
      .profile-subnav-wrap {
        padding: 0 14px 12px;
        margin-top: -12px;
      }
    }

    .profile-subnav {
      background: rgba(250,252,255,0.98);
      border-radius: var(--radius-pill);
      border: 1px solid var(--border-subtle);
      box-shadow: 0 8px 20px rgba(2,54,83,0.12);
      padding: 4px;
      display: inline-flex;
      gap: 4px;
      max-width: 100%;
      overflow-x: auto;
    }

    .profile-subnav::-webkit-scrollbar {
      height: 6px;
    }

    .profile-subnav-btn {
      border: none;
      background: transparent;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 0.8rem;
      color: var(--text-muted);
      cursor: pointer;
      white-space: nowrap;
      transition: color 0.16s ease, background 0.16s ease, box-shadow 0.16s ease;
    }

    .profile-subnav-btn.active {
      background: linear-gradient(135deg, var(--accent), var(--accent-strong));
      color: #EFF6FF;
      box-shadow: 0 6px 14px rgba(2,54,83,0.45);
    }

    /* BODY: TWO COLUMNS (same layout) */
    .profile-body {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.8fr);
      gap: 18px;
      margin-top: 16px;
    }

    @media (max-width: 980px) {
      .profile-body {
        grid-template-columns: minmax(0,1fr);
      }
    }

    .profile-col-left,
    .profile-col-right {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .section-heading {
      font-size: 0.9rem;
      font-weight: 600;
      margin: 0 0 4px;
    }

    .section-subtext {
      font-size: 0.78rem;
      color: var(--text-muted);
      margin: 0 0 8px;
    }

    /* ABOUT CARD */
    .about-card {
      padding: 12px 14px;
      background: var(--card);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-subtle);
      box-shadow: var(--shadow-soft);
    }

    .about-row {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 4px;
    }

    .about-item {
      display: flex;
      gap: 6px;
      font-size: 0.82rem;
    }

    .about-label {
      min-width: 80px;
      color: var(--text-muted);
    }

    /* FOCUS / SKILLS SUMMARY */
    .mini-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
    }

    @media (max-width: 640px) {
      .mini-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .mini-card {
      border-radius: var(--radius-md);
      padding: 10px;
      background: var(--card-soft);
      border: 1px solid var(--border-subtle);
      font-size: 0.8rem;
    }

    .mini-card-title {
      font-weight: 600;
      margin-bottom: 4px;
    }

    .pill-row { margin-top: 4px; gap: 6px; }

    /* BADGES */
    .badge-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(210px, 1fr));
      gap: 10px;
      margin-top: 4px;
    }

    .badge-mini {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 8px;
      padding: 10px;
      border-radius: 12px;
      border: 1px solid var(--border-subtle);
      background: linear-gradient(135deg, #F5FAFB, #FFFFFF);
      box-shadow: 0 8px 18px rgba(5, 108, 137, 0.16);
      align-items: center;
    }

    .badge-icon {
      width: 42px;
      height: 42px;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--accent), var(--accent-strong));
      color: #F8FAFC;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 1rem;
      box-shadow: 0 4px 12px rgba(2,54,83,0.35);
    }

    .badge-meta {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .badge-name { font-weight: 700; font-size: 0.92rem; }
    .badge-desc { font-size: 0.8rem; color: #475569; }
    .badge-date { font-size: 0.76rem; color: #6B7280; }

    /* GROUPS */
    .group-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 4px;
      font-size: 0.8rem;
    }

    .group-item {
      padding: 6px 8px;
      border-radius: 10px;
      background: #F8FAFC;
      border: 1px solid #D1DFE4;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }

    .group-meta {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .group-name { font-weight: 600; }

    /* BUDDIES MINI */
    .buddies-mini-list {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 6px;
    }

    .buddy-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 8px;
      border-radius: 999px;
      background: #EAF3F6;
      border: 1px solid var(--border-subtle);
      font-size: 0.78rem;
    }

    .buddy-avatar {
      width: 24px;
      height: 24px;
      border-radius: 999px;
      background: var(--accent-strong);
      color: #EAF3F6;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.76rem;
      font-weight: 600;
    }

    /* RIGHT COL: COMPOSER + FEED (same cards, read-only idea) */
    .composer-card {
      padding: 10px 14px;
      background: var(--card);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-subtle);
      box-shadow: var(--shadow-soft);
    }

    .composer-row {
      display: flex;
      gap: 8px;
      align-items: flex-start;
    }

    .composer-avatar {
      width: 36px;
      height: 36px;
      border-radius: 999px;
      background: var(--accent);
      color: #F9FAFB;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      font-weight: 600;
      flex-shrink: 0;
    }

    .composer-input-wrap { flex: 1; }

    .composer-input {
      width: 100%;
      min-height: 48px;
      border-radius: 18px;
      border: 1px solid #D1D5DB;
      padding: 8px 12px;
      font-size: 0.84rem;
      resize: vertical;
      outline: none;
      transition: border-color 0.15s ease, box-shadow 0.15s ease;
    }

    .composer-input:focus {
      border-color: #88B4BE;
      box-shadow: 0 0 0 1px rgba(8, 86, 110, 0.35);
    }

    .composer-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 6px;
      gap: 6px;
      flex-wrap: wrap;
    }

    .composer-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      font-size: 0.76rem;
    }

    .composer-tag {
      padding: 3px 7px;
      border-radius: var(--radius-pill);
      background: #F5FAFB;
      border: 1px solid #D1DFE4;
      cursor: pointer;
    }

    .feed-card {
      padding: 10px 14px;
      background: var(--card);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-subtle);
      box-shadow: var(--shadow-soft);
    }

    .feed-empty {
      font-size: 0.84rem;
      color: var(--text-muted);
    }

    .feed-item {
      padding: 8px 10px;
      border-radius: 12px;
      border: 1px solid #D1DFE4;
      background: #F8FAFC;
      margin-bottom: 8px;
      opacity: 0;
      transform: translateY(8px);
      transition: opacity 0.25s ease, transform 0.25s ease;
    }

    .feed-item.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .feed-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      font-size: 0.8rem;
      margin-bottom: 4px;
    }

    .feed-title { font-weight: 600; }

    .feed-meta {
      font-size: 0.78rem;
      color: var(--text-muted);
    }

    .feed-body {
      font-size: 0.84rem;
      margin-top: 4px;
    }

    .feed-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
      font-size: 0.76rem;
    }

    .tag-chip {
      padding: 3px 8px;
      border-radius: 999px;
      background: #E0F2FE;
      border: 1px solid #BAE6FD;
      color: #075985;
    }

    .chip {
      padding: 2px 7px;
      border-radius: 999px;
      background: #D6E6EB;
      color: var(--accent-strong);
      font-size: 0.75rem;
    }

    /* HOVER / MOTION (same as user profile) */
    .profile-cover,
    .about-card,
    .composer-card,
    .feed-card {
      transition:
        transform 0.2s ease,
        box-shadow 0.2s ease,
        border-color 0.2s ease;
    }

    .profile-cover:hover,
    .about-card:hover,
    .composer-card:hover,
    .feed-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 20px 40px rgba(2, 54, 83, 0.25);
      border-color: #88B4BE;
    }

    .mini-card,
    .group-item,
    .buddy-pill,
    .badge-mini,
    .feed-item {
      transition:
        transform 0.18s ease,
        box-shadow 0.18s ease,
        border-color 0.18s ease,
        background 0.18s ease;
    }

    .mini-card:hover,
    .group-item:hover,
    .buddy-pill:hover,
    .badge-mini:hover,
    .feed-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 24px rgba(2, 54, 83, 0.2);
      background: #F5FAFB;
    }

    .composer-tag {
      transition:
        background 0.15s ease,
        border-color 0.15s ease,
        transform 0.12s ease,
        box-shadow 0.15s ease;
    }

    .composer-tag:hover {
      background: #E0F2FE;
      border-color: #88B4BE;
      transform: translateY(-1px);
      box-shadow: 0 6px 14px rgba(2, 54, 83, 0.2);
    }

    .btn,
    .profile-subnav-btn {
      cursor: pointer;
    }

    /* REVEAL */
    .reveal {
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.45s ease, transform 0.45s ease;
    }

    .reveal.visible {
      opacity: 1;
      transform: translateY(0);
    }
  </style>
</head>
<body>
<div class="app-shell">
  <!-- SIDEBAR -->
  <nav class="sidebar" aria-label="Sidebar">
    <div class="brand">
      <div class="brand-mark">CB</div>
      <div class="brand-text">
        <div class="brand-title">Calibration</div>
        <div class="brand-subtitle">Discipline - Habits - Skills</div>
      </div>
    </div>

    <div class="nav">
      <a href="{% url 'dashboard' %}" class="nav-link">
        <span>Dashboard</span>
      </a>
      <a href="{% url 'disciplinebuilder' %}" class="nav-link">
        <span>Discipline Builder</span>
      </a>
      <a href="{% url 'progresstracker' %}" class="nav-link">
        <span>Progress Tracker</span>
      </a>
      <a href="{% url 'rewards' %}" class="nav-link">
        <span>Rewards</span>
      </a>
      <a href="{% url 'messages' %}" class="nav-link{% if has_unread_messages %} has-unread{% endif %}">
        <span>Messages</span>
      </a>
      <a href="{% url 'community' %}" class="nav-link">
        <span>Community</span>
      </a>
      <a href="{% url 'groups' %}" class="nav-link">
        <span>Groups</span>
      </a>
      <a href="{% url 'buddies' %}" class="nav-link">
        <span>Buddies</span>
      </a>
      <!-- Profile still points to YOUR profile -->
      <a href="{% url 'user_profile' %}" class="nav-link">
        <span>Profile</span>
      </a>
    </div>
  </nav>

  <!-- MAIN -->
  <main class="site-main">
    <header class="site-header">
      <div class="site-header-title">
        <h1>Profile</h1>
        <span>Viewing {{ profile_user.username }}'s Calibration identity.</span>
      </div>
      <div class="header-actions">
        <a href="{% url 'dashboard' %}" class="btn btn-ghost"><- Back</a>
        <a href="{% url 'messages' %}" class="btn btn-primary">Open Messages</a>
      </div>
    </header>

    <section class="profile-page">
      <!-- COVER / HEADER -->
      <div class="profile-cover card reveal" id="profile-cover">
        <div class="profile-cover-banner">
          <div class="profile-cover-overlay"></div>
        </div>
        <div class="profile-main-row">
          <div>
            <div class="profile-ident-row">
              <div class="profile-avatar-wrap">
                {% if profile.profile_picture %}
                  <img src="{{ profile.profile_picture.url }}" alt="{{ profile_user.username }} avatar">
                {% else %}
                  <img src="https://via.placeholder.com/200" alt="{{ profile_user.username }} avatar">
                {% endif %}
              </div>
              <div class="profile-name-meta">
                <h2>{{ profile_user.username }}</h2>
                <div class="profile-tagline">
                  <span id="greeting-label">Good day</span>
                  <span>-</span>
                  <span>Calibrating habits & skills</span>
                  <span class="profile-pill">Member since {{ profile_user.date_joined|date:"M Y" }}</span>
                </div>
                <p class="profile-bio">
                  {% if profile.bio %}
                    {{ profile.bio }}
                  {% else %}
                    Focused on consistent habits, long-term growth, and building skills that compound over time.
                  {% endif %}
                </p>
              </div>
            </div>

            <div class="profile-stats-row">
              <div class="profile-stat-pill">
                <span class="profile-stat-label">Total XP</span>
                <span class="profile-stat-value">{{ total_xp|default:0 }}</span>
              </div>
              <div class="profile-stat-pill">
                <span class="profile-stat-label">Streak</span>
                <span class="profile-stat-value">{{ login_streak|default:0 }} days</span>
              </div>
              <div class="profile-stat-pill">
                <span class="profile-stat-label">Skills</span>
                <span class="profile-stat-value">{{ skills_count|default:0 }}</span>
              </div>
              <div class="profile-stat-pill">
                <span class="profile-stat-label">Buddies</span>
                <span class="profile-stat-value">{{ friends|length|default:0 }}</span>
              </div>
            </div>
          </div>

          <div class="profile-actions-row">
            
            <a href="{% url 'messages' %}" class="btn btn-primary btn-sm">
              ✉️ Message (inbox)
            </a>
          </div>
        </div>

        <div class="profile-subnav-wrap">
          <div class="profile-subnav" id="profile-subnav">
            <button class="profile-subnav-btn active" data-section="section-timeline">Timeline</button>
            <button class="profile-subnav-btn" data-section="section-about">About</button>
            <button class="profile-subnav-btn" data-section="section-growth">Growth</button>
            <button class="profile-subnav-btn" data-section="section-buddies">Buddies</button>
          </div>
        </div>
      </div>

      <!-- BODY -->
      <div class="profile-body">
        <!-- LEFT COLUMN -->
        <div class="profile-col-left">
          <!-- ABOUT PANEL -->
          <article class="about-card reveal profile-section" id="section-about">
            <h2 class="section-heading">About</h2>
            <p class="section-subtext">Basic info for this Calibration profile.</p>
            <div class="about-row">
              <div class="about-item">
                <div class="about-label">Name</div>
                <div>{{ profile_user.get_full_name|default:profile_user.username }}</div>
              </div>
              <div class="about-item">
                <div class="about-label">Timezone</div>
                <div>Not shared</div>
              </div>
              <div class="about-item">
                <div class="about-label">Focus</div>
                <div>{{ profile.bio|default:"Discipline & skill-building" }}</div>
              </div>
              <div class="about-item">
                <div class="about-label">Joined</div>
                <div>{{ profile_user.date_joined|date:"F j, Y" }}</div>
              </div>
            </div>
          </article>

          <!-- FOCUS / SKILLS SUMMARY -->
          <article class="about-card reveal profile-section" id="section-growth">
            <h2 class="section-heading">Focus Areas</h2>
            <p class="section-subtext">Where {{ profile_user.username }} has been building lately.</p>
            <div class="mini-grid">
              <div class="mini-card">
                <div class="mini-card-title">Top Skills</div>
                <div class="pill-row">
                  {% for s in skills_data|slice:":4" %}
                    <span class="pill">{{ s.name }} - L{{ s.level }}</span>
                  {% empty %}
                    <span class="muted">{{ profile_user.username }} hasn't added skills yet.</span>
                  {% endfor %}
                </div>
              </div>
              <div class="mini-card">
                <div class="mini-card-title">Core Habits</div>
                <div class="pill-row">
                  {% for h in habits_data|slice:":4" %}
                    <span class="pill">{{ h.name }}</span>
                  {% empty %}
                    <span class="muted">{{ profile_user.username }} hasn't added habits yet.</span>
                  {% endfor %}
                </div>
              </div>
            </div>
          </article>

          <!-- BADGES -->
          <article class="about-card reveal">
            <h2 class="section-heading">Badges</h2>
            <p class="section-subtext">Visible milestones unlocked by this user.</p>
            <div class="badge-grid">
              <div class="badge-mini">
                <div class="badge-icon">P</div>
                <div class="badge-meta">
                  <div class="badge-name">Profile Created</div>
                  <div class="badge-desc">Their Calibration account is live.</div>
                  <div class="badge-date">Since {{ profile_user.date_joined|date:"M d, Y" }}</div>
                </div>
              </div>

              {% if skills_count|default:0 > 0 %}
                <div class="badge-mini">
                  <div class="badge-icon">S</div>
                  <div class="badge-meta">
                    <div class="badge-name">First Skill</div>
                    <div class="badge-desc">At least one skill has been added.</div>
                    <div class="badge-date">Ongoing</div>
                  </div>
                </div>
              {% endif %}

              {% if login_streak|default:0 >= 7 %}
                <div class="badge-mini">
                  <div class="badge-icon">7</div>
                  <div class="badge-meta">
                    <div class="badge-name">7-day Streak</div>
                    <div class="badge-desc">A full week of consistent check-ins.</div>
                    <div class="badge-date">Active streak</div>
                  </div>
                </div>
              {% endif %}

              {% if login_streak|default:0 >= 30 %}
                <div class="badge-mini">
                  <div class="badge-icon">30</div>
                  <div class="badge-meta">
                    <div class="badge-name">30-day Streak</div>
                    <div class="badge-desc">A month of steady Calibration work.</div>
                    <div class="badge-date">Legend status</div>
                  </div>
                </div>
              {% endif %}
            </div>
          </article>

                    <!-- GROUPS -->
          <article class="about-card reveal">
            <h2 class="section-heading">Groups</h2>
            <p class="section-subtext">
              Calibration groups {{ profile_user.username }} belongs to.
            </p>
            <div class="group-list">
              {% if groups %}
                {% for g in groups %}
                  <a class="group-item" href="{% url 'group_detail' g.id %}" style="display:flex; color:inherit; text-decoration:none;">
                    <div class="group-meta">
                      <span class="group-name">{{ g.name }}</span>
                      <span class="muted">{{ g.category|default:"Group" }}</span>
                      {% if g.description %}
                        <span class="muted">{{ g.description|truncatechars:110 }}</span>
                      {% endif %}
                    </div>
                    <span class="chip">
                      Members {{ g.members.count }} member{{ g.members.count|pluralize }}
                    </span>
                  </a>
                {% endfor %}
              {% else %}
                <p class="muted">{{ profile_user.username }} is not in any groups yet.</p>
              {% endif %}
            </div>
          </article>
          <!-- BUDDIES MINI -->
          <article class="about-card reveal profile-section" id="section-buddies">
            <h2 class="section-heading">Buddies</h2>
            <p class="section-subtext">
              A quick look at some of {{ profile_user.username }}'s buddies.
            </p>
            <div class="buddies-mini-list">
              {% for buddy in friends|slice:":6" %}
                <div class="buddy-pill">
                  <div class="buddy-avatar">{{ buddy.user.username|slice:":2"|upper }}</div>
                  <span>{{ buddy.user.username }}</span>
                </div>
              {% empty %}
                <span class="muted">{{ profile_user.username }} has no buddies yet.</span>
              {% endfor %}
            </div>
          </article>
        </div>

        <!-- RIGHT COLUMN -->
        <div class="profile-col-right">
          <!-- FEED -->
          <article class="feed-card reveal profile-section" id="section-timeline">
            <h2 class="section-heading">Public Activity</h2>
            <p class="section-subtext">
              Public activity from this account (skills, habits, journals).
            </p>

            <div id="feed-list">
              {% if recent_activity %}
                {% for item in recent_activity %}
                  <div class="feed-item">
                    <div class="feed-header">
                      <div>
                        <div class="feed-title">{{ item.title }}</div>
                        <div class="feed-meta">{{ item.meta }}</div>
                      </div>
                      <span class="chip">{{ item.type|default:"Activity" }}</span>
                    </div>
                    {% if item.body %}
                      <div class="feed-body">{{ item.body }}</div>
                    {% endif %}
                    <div class="feed-tags">
                      {% if item.tag %}
                        <span class="tag-chip">{{ item.tag }}</span>
                      {% endif %}
                      {% if item.mood %}
                        <span class="tag-chip">Mood: {{ item.mood }}</span>
                      {% endif %}
                    </div>
                  </div>
                {% endfor %}
              {% else %}
                <p class="feed-empty">
                  No public activity visible yet.
                </p>
              {% endif %}
            </div>
          </article>
        </div>
      </div>
    </section>
  </main>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    /* GREETING */
    const greetingLabel = document.getElementById("greeting-label");
    const now = new Date();
    const hour = now.getHours();
    let greeting = "Good day";
    if (hour < 6) greeting = "Up late";
    else if (hour < 12) greeting = "Good morning";
    else if (hour < 18) greeting = "Good afternoon";
    else greeting = "Good evening";
    if (greetingLabel) greetingLabel.textContent = greeting;

    /* SUBNAV SWITCHING */
    const subnavBtns = document.querySelectorAll(".profile-subnav-btn");

    function smartScroll(target) {
      if (!target) return;
      const rect = target.getBoundingClientRect();
      const offset = rect.top + window.scrollY - 90;
      window.scrollTo({ top: offset, behavior: "smooth" });
    }

    subnavBtns.forEach(btn => {
      btn.addEventListener("click", () => {
        const targetId = btn.getAttribute("data-section");
        subnavBtns.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        const targetEl = document.getElementById(targetId);
        smartScroll(targetEl);
      });
    });

    /* QUICK SCROLL BUTTONS */
    const scrollTimelineBtn = document.getElementById("btn-scroll-timeline");
    const scrollAboutBtn = document.getElementById("btn-scroll-about");
    const timelineSection = document.getElementById("section-timeline");
    const aboutSection = document.getElementById("section-about");

    scrollTimelineBtn && scrollTimelineBtn.addEventListener("click", () => smartScroll(timelineSection));
    scrollAboutBtn && scrollAboutBtn.addEventListener("click", () => smartScroll(aboutSection));

    /* REVEAL ON SCROLL */
    const revealEls = document.querySelectorAll(".reveal");
    if ("IntersectionObserver" in window) {
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add("visible");
            observer.unobserve(entry.target);
          }
        });
      }, { threshold: 0.12 });

      revealEls.forEach(el => observer.observe(el));
    } else {
      revealEls.forEach(el => el.classList.add("visible"));
    }

    /* FEED ITEM ANIMATIONS */
    const feedItems = document.querySelectorAll(".feed-item");
    feedItems.forEach((item, index) => {
      setTimeout(() => {
        item.classList.add("visible");
      }, 120 + index * 80);
    });
  });
</script>
</body>
</html>


